(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1403],{1048:(e,t,r)=>{"use strict";r.d(t,{default:()=>p});var a=r(5155),s=r(2115),i=r(2619),n=r.n(i),o=r(3209),d=r(7812),l=r(7003),c=r(6170),u=r(7001),m=r(6983);let x=(0,r(1847).A)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);function p(e){let{initialPosts:t}=e,[r,i]=(0,s.useState)(t),[p,g]=(0,s.useState)(""),[v,f]=(0,s.useState)(""),[b,y]=(0,s.useState)(""),[j,w]=(0,s.useState)(""),[N,k]=(0,s.useState)(""),[C,S]=(0,s.useState)(""),[A,E]=(0,s.useState)(""),[T,D]=(0,s.useState)(!1),[L,O]=(0,s.useState)(null),z=async e=>{if(e.preventDefault(),p.trim()&&v.trim()){D(!0),O(null);try{let e=await fetch("/api/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:p.trim(),content:v.trim(),mediaUrl:b.trim()||void 0,mediaType:j||void 0,eventDate:N||void 0,eventLocation:C||void 0})});if(!e.ok){let t=await e.json().catch(()=>({}));O("string"==typeof(null==t?void 0:t.error)?t.error:"N\xe3o foi poss\xedvel publicar.");return}let{post:t}=await e.json();i(e=>[t,...e]),g(""),f(""),y(""),w(""),k(""),S(""),E("")}catch(e){console.error(e),O("Erro inesperado. Tente novamente.")}finally{D(!1)}}},B=async(e,t)=>{try{if(!(await fetch("/api/posts/".concat(e,"/like"),{method:t?"DELETE":"POST"})).ok)return;i(r=>r.map(r=>r.id===e?{...r,likedByCurrent:!t,likesCount:r.likesCount+(t?-1:1)}:r))}catch(e){console.error(e)}},P=async(e,t)=>{try{if(!(await fetch("/api/users/".concat(e,"/follow"),{method:t?"DELETE":"POST"})).ok)return;i(r=>r.map(r=>r.author.id===e?{...r,isFollowingAuthor:!t}:r))}catch(e){console.error(e)}},_=async(e,t)=>{try{let r=await fetch("/api/posts/".concat(e,"/comments"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:t})});if(!r.ok)return;let{comment:a}=await r.json();i(r=>r.map(r=>r.id===e?{...r,commentsCount:r.commentsCount+1,comments:[...r.comments,{id:a.id,content:t,author:{id:a.authorId,name:"Voc\xea"},createdAt:new Date().toISOString()}]}:r))}catch(e){console.error(e)}},R=async e=>{try{let t=await fetch("/api/posts/".concat(e,"/share"),{method:"POST"});if(!t.ok)return;let{post:r}=await t.json();i(e=>e.map(e=>e.id===r.id?{...e,shareCount:r.shareCount}:e)),navigator.share&&await navigator.share({title:"EDUCONEXA",url:"".concat(window.location.origin,"/feed")})}catch(e){console.error(e)}};return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-primary to-secondary p-6 md:p-8 lg:p-10 text-white sticky top-0 z-10",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-2xl md:text-3xl lg:text-4xl font-bold text-white",children:"Feed"}),(0,a.jsx)("p",{className:"text-white/90 text-sm md:text-base lg:text-lg",children:"Publique e acompanhe a comunidade"})]})}),(0,a.jsxs)("div",{className:"p-6 md:p-8 lg:p-10 space-y-4 md:space-y-6 max-w-4xl mx-auto",children:[(0,a.jsxs)(o.Zp,{className:"border-border/50",children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsx)(o.ZB,{className:"text-lg md:text-xl",children:"Criar postagem"}),(0,a.jsx)(o.BT,{children:"Compartilhe novidades, eventos ou ideias."})]}),(0,a.jsx)(o.Wu,{children:(0,a.jsxs)("form",{className:"space-y-3 md:space-y-4",onSubmit:z,children:[(0,a.jsx)(c.p,{placeholder:"T\xedtulo",value:p,onChange:e=>g(e.target.value),required:!0,maxLength:140}),(0,a.jsx)(u.T,{placeholder:"No que voc\xea est\xe1 pensando?",value:v,onChange:e=>f(e.target.value),required:!0,rows:4}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,a.jsx)(c.p,{placeholder:"URL de m\xeddia (imagem/v\xeddeo/link) opcional",value:b,onChange:e=>y(e.target.value)}),(0,a.jsx)(c.p,{placeholder:"Tipo de m\xeddia (IMAGE, VIDEO, LINK)",value:j,onChange:e=>w(e.target.value)}),(0,a.jsx)(c.p,{type:"datetime-local",placeholder:"Data do evento (opcional)",value:N,onChange:e=>k(e.target.value)}),(0,a.jsx)(c.p,{placeholder:"Local do evento (opcional)",value:C,onChange:e=>S(e.target.value)}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("label",{className:"text-sm text-muted-foreground",children:"Ou envie uma imagem/v\xeddeo do dispositivo"}),(0,a.jsx)(c.p,{type:"file",accept:"image/*,video/*",onChange:e=>{var t;let r=null==(t=e.target.files)?void 0:t[0];if(!r)return;let a=new FileReader;a.onload=()=>{"string"==typeof a.result&&(y(a.result),w(r.type||"UPLOAD"),E(r.name))},a.readAsDataURL(r)}}),A&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Selecionado: ",A]})]})]}),L&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:L}),(0,a.jsx)(l.$,{type:"submit",disabled:T,className:"w-full md:w-auto",children:T?"Publicando...":"Publicar"})]})})]}),0===r.length&&(0,a.jsx)(o.Zp,{className:"border-border/50",children:(0,a.jsx)(o.Wu,{className:"py-10 text-center text-muted-foreground",children:"Nenhuma postagem ainda."})}),r.map(e=>{var t;return(0,a.jsxs)(o.Zp,{className:"border-border/50 hover:shadow-md transition-shadow",children:[(0,a.jsxs)(o.aR,{className:"pb-3 md:pb-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-2",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)(n(),{href:"/users/".concat(e.author.id),className:"font-semibold text-base md:text-lg hover:text-primary transition-colors",children:e.author.name||e.author.email}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:e.author.email})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[!e.isSelf&&(0,a.jsx)(l.$,{size:"sm",variant:e.isFollowingAuthor?"outline":"default",onClick:()=>{var t;return P(e.author.id,null!=(t=e.isFollowingAuthor)&&t)},children:e.isFollowingAuthor?"Seguindo":"Seguir"}),(0,a.jsx)(d.E,{variant:"secondary",className:"bg-accent/20 text-accent-foreground text-xs md:text-sm",children:"Post"})]})]}),(0,a.jsx)(o.ZB,{className:"text-lg md:text-xl leading-tight",children:e.title}),(0,a.jsx)(o.BT,{className:"text-sm md:text-base leading-relaxed whitespace-pre-wrap",children:e.content}),e.mediaUrl&&(0,a.jsx)("div",{className:"mt-3",children:(null==(t=e.mediaType)?void 0:t.toLowerCase().includes("video"))?(0,a.jsx)("div",{className:"aspect-video w-full overflow-hidden rounded-lg border border-border/70",children:(0,a.jsx)("iframe",{src:e.mediaUrl,className:"w-full h-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,title:e.title})}):e.mediaUrl.startsWith("data:")?(0,a.jsx)("img",{src:e.mediaUrl,alt:e.title,className:"w-full rounded-lg border border-border/70"}):(0,a.jsx)("a",{href:e.mediaUrl,className:"text-primary underline break-all",target:"_blank",rel:"noreferrer",children:e.mediaUrl})}),e.eventDate&&(0,a.jsxs)("div",{className:"mt-2 text-xs text-muted-foreground",children:["Evento: ",new Date(e.eventDate).toLocaleString("pt-BR")," ",e.eventLocation&&"• ".concat(e.eventLocation)]})]}),(0,a.jsxs)(o.Wu,{className:"pt-0",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm md:text-base text-muted-foreground border-t pt-3 md:pt-4",children:[(0,a.jsxs)("span",{className:"flex items-center gap-2 text-xs md:text-sm",children:[(0,a.jsx)(m.A,{className:"h-4 w-4"}),new Date(e.createdAt).toLocaleString("pt-BR",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 md:gap-6",children:[(0,a.jsxs)("button",{className:"flex items-center gap-2 hover:text-primary transition-colors",onClick:()=>B(e.id,e.likedByCurrent),children:[(0,a.jsx)("span",{children:e.likedByCurrent?"❤":"♡"}),(0,a.jsx)("span",{className:"text-xs md:text-sm",children:e.likesCount})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(x,{className:"h-4 w-4 md:h-5 md:w-5"}),(0,a.jsx)("span",{className:"text-xs md:text-sm",children:e.commentsCount})]}),(0,a.jsxs)("button",{className:"text-xs md:text-sm hover:text-primary",onClick:()=>R(e.id),children:["Compartilhar (",e.shareCount,")"]})]})]}),(0,a.jsxs)("div",{className:"mt-3 space-y-2",children:[e.comments.map(e=>(0,a.jsxs)("div",{className:"border border-border/50 rounded p-2 text-sm",children:[(0,a.jsx)("div",{className:"font-semibold",children:e.author.name}),(0,a.jsx)("div",{className:"text-muted-foreground text-xs mb-1",children:new Date(e.createdAt).toLocaleString("pt-BR",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"short"})}),(0,a.jsx)("p",{className:"whitespace-pre-wrap",children:e.content})]},e.id)),(0,a.jsx)(h,{onSubmit:t=>_(e.id,t)})]})]})]},e.id)})]})]})}function h(e){let{onSubmit:t}=e,[r,i]=(0,s.useState)(""),[n,o]=(0,s.useState)(!1);return(0,a.jsxs)("form",{className:"flex gap-2 items-start",onSubmit:async e=>{e.preventDefault(),r.trim()&&(o(!0),await t(r.trim()),i(""),o(!1))},children:[(0,a.jsx)(u.T,{placeholder:"Comente algo...",value:r,onChange:e=>i(e.target.value),className:"min-h-[70px]"}),(0,a.jsx)(l.$,{type:"submit",disabled:n,className:"h-10 mt-1",children:n?"...":"Enviar"})]})}},1847:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(2115);let s=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:n=24,strokeWidth:o=2,absoluteStrokeWidth:d,className:l="",children:c,iconNode:u,...m}=e;return(0,a.createElement)("svg",{ref:t,...i,width:n,height:n,stroke:r,strokeWidth:d?24*Number(o)/Number(n):o,className:s("lucide",l),...m},[...u.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(c)?c:[c]])}),o=(e,t)=>{let r=(0,a.forwardRef)((r,i)=>{let{className:o,...d}=r;return(0,a.createElement)(n,{ref:i,iconNode:t,className:s("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),o),...d})});return r.displayName="".concat(e),r}},2768:(e,t,r)=>{Promise.resolve().then(r.bind(r,1048))},3209:(e,t,r)=>{"use strict";r.d(t,{BT:()=>d,Wu:()=>l,ZB:()=>o,Zp:()=>i,aR:()=>n});var a=r(5155);r(2115);var s=r(5016);function i(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...r})}function n(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...r})}function o(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",t),...r})}function d(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",t),...r})}function l(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",t),...r})}},5016:(e,t,r)=>{"use strict";r.d(t,{cn:()=>i});var a=r(2821),s=r(5889);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}},6170:(e,t,r)=>{"use strict";r.d(t,{p:()=>i});var a=r(5155);r(2115);var s=r(5016);function i(e){let{className:t,type:r,...i}=e;return(0,a.jsx)("input",{type:r,"data-slot":"input",className:(0,s.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...i})}},6983:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(1847).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},7001:(e,t,r)=>{"use strict";r.d(t,{T:()=>i});var a=r(5155);r(2115);var s=r(5016);function i(e){let{className:t,...r}=e;return(0,a.jsx)("textarea",{"data-slot":"textarea",className:(0,s.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...r})}},7003:(e,t,r)=>{"use strict";r.d(t,{$:()=>d});var a=r(5155);r(2115);var s=r(2467),i=r(3101),n=r(5016);let o=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function d(e){let{className:t,variant:r,size:i,asChild:d=!1,...l}=e,c=d?s.DX:"button";return(0,a.jsx)(c,{"data-slot":"button",className:(0,n.cn)(o({variant:r,size:i,className:t})),...l})}},7812:(e,t,r)=>{"use strict";r.d(t,{E:()=>d});var a=r(5155);r(2115);var s=r(2467),i=r(3101),n=r(5016);let o=(0,i.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function d(e){let{className:t,variant:r,asChild:i=!1,...d}=e,l=i?s.DX:"span";return(0,a.jsx)(l,{"data-slot":"badge",className:(0,n.cn)(o({variant:r}),t),...d})}}},e=>{e.O(0,[2619,5707,8441,1255,7358],()=>e(e.s=2768)),_N_E=e.O()}]);